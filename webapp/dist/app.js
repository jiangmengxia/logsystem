!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=3)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RET=t.Method=t.NOOP=void 0,t.NOOP=function(){},function(e){e.GET="GET",e.POST="POST"}(t.Method||(t.Method={})),function(e){e[e.SUCCESS=1]="SUCCESS",e[e.FAILED=0]="FAILED"}(t.RET||(t.RET={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timestampToDateTime=t.ONE_DAY_TIME_SPAN=t.dayFormat2Date=t.getStartOfDay=t.dateFormat2Day=t.isValidDay=t.sizeOf=t.M_BYTE=t.K_BYTE=void 0,t.K_BYTE=1024,t.M_BYTE=1024*t.K_BYTE,t.sizeOf=function(e){for(var t=0,n=0,r=e.length;n<r;n++){var o=e.charCodeAt(n);t+=o<=127?1:o<=2047?2:o<=65535?3:4}return t},t.isValidDay=function(e){if("string"!=typeof e)return!1;var t=e.split("-"),n=parseInt(t[1]),r=parseInt(t[2]);return n>0&&n<=12&&r>0&&r<=31&&"Invalid Date"!==new Date(e).toString()},t.dateFormat2Day=function(e){var t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();return t+"-"+(n<10?"0"+n:n)+"-"+(r<10?"0"+r:r)},t.getStartOfDay=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()},t.dayFormat2Date=function(e){var t=(e.match(/(\d+)/g)||[]).map((function(e){return parseInt(e)})),n=t[0],r=t[1],o=t[2];if(n<1e3)throw new Error("Invalid dayString: "+e);return new Date(n,r-1,o)},t.ONE_DAY_TIME_SPAN=864e5,t.timestampToDateTime=function(e,t){if(void 0===e&&(e=Date.now()),void 0===t&&(t="yyyy-MM-dd HH:mm:ss"),isNaN(e))return"";if(t.length<4||0!=="yyyy-MM-dd HH:mm:ss".indexOf(t))return"";var n=new Date(Number(e)),r=n.getFullYear(),o=n.getMonth()+1,i=n.getDate(),u=n.getHours(),a=n.getMinutes(),s=n.getSeconds();return t.replace("yyyy",""+r).replace("MM",""+(o>9?o:"0"+o)).replace("dd",""+(i>9?i:"0"+i)).replace("HH",""+(u>9?u:"0"+u+" ")).replace("mm",""+(a>9?a:"0"+a)).replace("ss",""+(s>9?s:"0"+s))}},function(e,t,n){"use strict";var r,o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.default={set:function(e){e?e.url?r=o({},e):console.error("url must be provided"):console.error("请配置config")},get:function(e){return r[e]},getAll:function(){return r}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.logRegist=void 0;var o,i=n(4),u=n(0),a=n(1);function s(e,t){void 0===t&&(t=!1);var n={userId:"userId",token:"",networkStatus:"",appSessionId:"",pageSessionId:"",pageId:"",pageTitle:""};i.default.getInstance({useWorker:t,url:"http://47.101.37.38:38080/app/mock/22/kxd/hera/user/add",method:u.Method.POST,headers:{"jzx-appid":"",ACCESS_TOKEN:""},repeat:0,duration:1e3,handleResponse:function(e){var t=JSON.parse(e);return{ret:t.isOk?u.RET.SUCCESS:u.RET.FAILED,error:t.errMsg}},handleRequest:function(e){return{data:e.reduce((function(e,t){return e.push(r(r({},t),n)),e}),[])}}}).report(e)}(o=document.createElement("button")).innerText="测试batch处理log存储",o.addEventListener("click",(function(){s({type:"NO.__",content:"NO.__"+a.timestampToDateTime()},!1)})),document.body.append(o),function(e){var t=document.createElement("button");t.innerText="批量发送log",t.addEventListener("click",(function(){!function(e){void 0===e&&(e=!1);console.info("开始计时：",Date.now());var t=1,n=setInterval((function(){t<=100?(console.log("send No."+t+" LOG"),s({type:"NO."+t+"__",content:"NO."+t+"__"+a.timestampToDateTime(),isImmediate:Math.ceil(10*Math.random())%2==1},e),t++):clearInterval(n)}))}(e)})),document.body.append(t)}(!1),function(){var e=document.createElement("input");e.style.width="300px",e.style.height="60px",e.placeholder="请输入立即待上报的日志内容";var t=document.createElement("div");t.innerText="\n",document.body.append(t),e.onkeypress=function(t){13===t.keyCode&&s({type:"test_immediate_table",content:e.value,isImmediate:!0})},document.body.append(e)}(),t.logRegist=s},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,a)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(5),a=n(2),s=function(){function e(e){this.manager=null,this.useWorker=!1,e.useWorker&&(Worker?this.useWorker=!0:console.error("your browser is not support webWorker , so we recomand normal scheme to call LogManager")),this.init(e)}return e.getInstance=function(t){return null===this.instance_&&(this.instance_=new e(t)),this.instance_},e.prototype.init=function(e){return o(this,void 0,void 0,(function(){var t,n=this;return i(this,(function(r){return a.default.set(e),this.useWorker?(t=Worker?new Worker("webworker.js"):null,this.manager=t,this.manager.postMessage({v:"init",config:e}),[2]):[2,new Promise((function(e){n.manager=u.default.getInstance((function(){e("ok")}))}))]}))}))},e.prototype.report=function(e){this.useWorker?this.manager.postMessage(r({v:"log"},e)):this.manager.regist(e)},e.instance_=null,e}();t.default=s},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,a)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),u=n(9),a=n(1),s=n(10),c=n(0),l=n(2),f=n(13),h=function(){function e(e){var t=this;this.logDB=null,this.logReporter=null,this.logQueue=null,this.today=null,this.dailyRemoved=!1,this.logReporter=new s.default,this.operationQueue=new u.default,this.logQueue=new f.default((function(e){t.operationQueue.invokeInQueue((function(){var n=e.reduce((function(e,t){return!0===t.isImmediate?e.ImLogs.push(t):e.logs.push(t),e}),{ImLogs:[],logs:[]}),r=n.ImLogs,o=n.logs;r.length>0&&t.reportImmediately(r),o.length>0&&t.logDB.addLogItems(o).then((function(e){e.ret,e.data}))}))})),this.today=a.dateFormat2Day(new Date),this.init(e)}return e.prototype.init=function(e){return r(this,void 0,void 0,(function(){var t=this;return o(this,(function(n){return this.logDB=new i.default(l.default.get("DBName"),(function(){return r(t,void 0,void 0,(function(){var t=this;return o(this,(function(n){switch(n.label){case 0:return e&&e(),[4,this.logDB.getDayRemovedDayInfo()];case 1:return n.sent(),this.dailyRemoved?this.logQueue.startOperate():this.reportDaily().then((function(){console.log("--today第一次清除---今日完成清除---"),t.logQueue.startOperate()})),[2]}}))}))})),[2]}))}))},e.getInstance=function(t){return null===this.instance_&&(this.instance_=new e(t)),this.instance_},e.prototype.regist=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){return this.logQueue.invokePushQueue(e),[2]}))}))},e.prototype.reportImmediateLogsUnReported=function(){return r(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return[4,this.logDB.getAllImediateLogs()];case 1:return(e=t.sent()).length>0?(this.reportLogs(e,(function(){})),[2]):[2]}}))}))},e.prototype.reportDaily=function(){return r(this,void 0,void 0,(function(){var e=this;return o(this,(function(t){switch(t.label){case 0:return[4,this.operationQueue.invokeInQueue((function(){return e.reportDaily_()}))];case 1:return[2,t.sent()]}}))}))},e.prototype.reportDaily_=function(){return r(this,void 0,void 0,(function(){var e,t,n=this;return o(this,(function(i){switch(i.label){case 0:return[4,this.logDB.getAllLogDays()];case 1:return e=i.sent()||[],[4,this.logDB.getLogsByReportName(e.map((function(e){return e.logDay})))];case 2:return t=i.sent()||[],[2,this.reportLogs(t,(function(){return r(n,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return[4,this.logDB.incrementalDeleteLogs(t,e)];case 1:return n.sent(),this.dailyRemoved=!0,this.logDB.updateDayRemovedInfo(this.today),console.info("Daily Report LOGs  has  success"),[2]}}))}))}))]}}))}))},e.prototype.reportLogs=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return 0===e.length?[2]:[4,this.logReporter.report({data:e})];case 1:return n=r.sent(),console.log("reportDaily callback data",n),n.ret===c.RET.SUCCESS?t&&t(n):console.error(n.error),[2]}}))}))},e.prototype.reportImmediately=function(e){return r(this,void 0,void 0,(function(){var t=this;return o(this,(function(n){return 0===e.length||this.logDB.addLogItemsImmediate(e).then((function(e){var n=e.ret,i=e.data;return r(t,void 0,void 0,(function(){var e,t=this;return o(this,(function(u){switch(u.label){case 0:return n!==c.RET.SUCCESS?[3,2]:(console.log("存储日志记录成功",i.ids),[4,this.logDB.getLogItemsImmediate(i.ids)]);case 1:e=u.sent(),this.reportLogs(e,(function(){return r(t,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,this.logDB.incrementDeleteLogsInImmediateTable(i.ids)];case 1:return e.sent(),[2]}}))}))})),u.label=2;case 2:return[2]}}))}))})),[2]}))}))},e.prototype.errorHandler=function(){},e.instance_=null,e}();t.default=h},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,a)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(7),a=n(1),s=n(0),c=function(){function e(e,t){var n=this;void 0===e&&(e="jzx_log_db"),void 0===t&&(t=s.NOOP),this.db=null,this.dbError=null,this.tbLog=null;var r=new u.default({name:e,version:1,itemDuration:6048e5,stores:[{name:"jzx_log_immediate_table",keyPath:"id",autoIncrement:!0,indexes:[{name:"logReportName",unique:!1,keyPath:"logReportName"},{name:"logCreateTime",unique:!1,keyPath:"logCreateTime"}]},{name:"jzx_log_table",keyPath:"id",autoIncrement:!0,indexes:[{name:"logReportName",unique:!1,keyPath:"logReportName"},{name:"logCreateTime",unique:!1,keyPath:"logCreateTime"}]},{name:"jzx_log_day_table",autoIncrement:!0,keyPath:"logDay",indexs:[{name:"logDay",unique:!0,keyPath:"logDay"}]},{name:"log_last_removed_day_table",autoIncrement:!0,keyPath:"last_removed_day",indexs:[{name:"last_removed_day",unique:!0,keyPath:"last_removed_day"}]}]});r.connect().then((function(e){console.log("数据库连接成功"+r+"--------- ",e),n.db=r,t&&t()}))}return e.prototype.judgeDBIsConnected=function(){null!==this.db||console.log("db is not avalable")},e.prototype.addLogItem=function(e){return o(this,void 0,void 0,(function(){var t,n,o,u,c,l;return i(this,(function(i){switch(i.label){case 0:return this.judgeDBIsConnected(),console.log("存储日志",e),t=a.dateFormat2Day(new Date),n=this.db.use("jzx_log_table"),!0===e.isImmediate?[2,this.addLogItemImmediate(e)]:(o=this.db.use("jzx_log_day_table"),[4,n.add(r((c={},c.logReportName=t,c.logCreateTime=Date.now(),c),e))]);case 1:return u=i.sent(),o&&o.put(((l={}).logDay=t,l)),[2,{ret:s.RET.SUCCESS,data:{id:u}}]}}))}))},e.prototype.addLogItems=function(e){return o(this,void 0,void 0,(function(){var t,n,o,u,c,l;return i(this,(function(i){switch(i.label){case 0:return console.log("addLogItems存储多条日志",e),this.judgeDBIsConnected(),t=a.dateFormat2Day(new Date),n=this.db.use("jzx_log_table"),o=this.db.use("jzx_log_day_table"),u=e.map((function(e){return function(n){var o;return n.add(r(((o={}).logReportName=t,o.logCreateTime=Date.now(),o),e))}})),[4,n.batch(u)];case 1:return c=i.sent(),o&&o.put(((l={}).logDay=t,l)),console.log("ids  addLogItems",c),[2,{ret:s.RET.SUCCESS,data:{ids:c}}]}}))}))},e.prototype.getLogsByReportName=function(e){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return this.judgeDBIsConnected(),t=this.db.use("jzx_log_table"),"String"!==e.constructor.name?[3,2]:[4,t.query("logReportName",e)];case 1:return[2,r.sent()];case 2:return"Array"!==e.constructor.name?[3,4]:(n=e.map((function(e){return{key:"logReportName",value:e,optional:!0}})),[4,t.select(n)]);case 3:return[2,r.sent()];case 4:return[2]}}))}))},e.prototype.getAllLogDays=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this.judgeDBIsConnected(),[4,this.db.use("jzx_log_day_table").all()];case 1:return[2,e.sent()||[]]}}))}))},e.prototype.incrementalDeleteByDay=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o;return i(this,(function(i){switch(i.label){case 0:return this.judgeDBIsConnected(),console.log("incrementalDeleteByDay"),t=this.db.use("jzx_log_table"),n=this.db.use("jzx_log_day_table"),[4,this.getLogsByReportName(e)];case 1:return(r=i.sent())?(o=r.map((function(e){return function(t){return t.delete(e.id)}})),[4,t.batch(o)]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,n.delete(e)];case 4:return i.sent(),[2]}}))}))},e.prototype.incrementalDeleteLogs=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return this.judgeDBIsConnected(),console.log("正在删除删除的logs",e),n=this.db.use("jzx_log_table"),r=this.db.use("jzx_log_day_table"),e&&e.length>0?(o=e.map((function(e){return function(t){return t.delete(e.id)}})),[4,n.batch(o)]):[3,2];case 1:i.sent(),i.label=2;case 2:return console.log("待删除days",t),t&&t.length>0?(o=t.map((function(e){return function(t){return t.delete(e.logDay)}})),[4,r.batch(o)]):[3,4];case 3:i.sent(),i.label=4;case 4:return[2,{ret:s.RET.SUCCESS}]}}))}))},e.prototype.updateDayRemovedInfo=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return[4,(t=this.db.use("log_last_removed_day_table")).last()];case 1:return(n=o.sent())?(n.last_removed_day=e,[4,t.put(n)]):[3,3];case 2:return[2,o.sent()];case 3:return[4,t.put((r={},r.last_removed_day=e,r))];case 4:return[2,o.sent()]}}))}))},e.prototype.getDayRemovedDayInfo=function(){return o(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return[4,this.db.use("log_last_removed_day_table").last()];case 1:return(e=t.sent())?[2,e.last_removed_day]:[2,null]}}))}))},e.prototype.addLogItemImmediate=function(e){return o(this,void 0,void 0,(function(){var t,n,o;return i(this,(function(i){switch(i.label){case 0:return t=this.db.use("jzx_log_immediate_table"),n=a.dateFormat2Day(new Date),[4,t.add(r((o={},o.logReportName=n,o.logCreateTime=Date.now(),o),e))];case 1:return[2,i.sent()]}}))}))},e.prototype.addLogItemsImmediate=function(e){return o(this,void 0,void 0,(function(){var t,n,o,u;return i(this,(function(i){switch(i.label){case 0:return t=this.db.use("jzx_log_immediate_table"),n=a.dateFormat2Day(new Date),o=e.map((function(e){return function(t){var o;return t.add(r(((o={}).logReportName=n,o.logCreateTime=Date.now(),o),e))}})),[4,t.batch(o)];case 1:return[2,{ret:(u=i.sent())?s.RET.SUCCESS:s.RET.FAILED,data:{ids:u}}]}}))}))},e.prototype.getLogItemImmediate=function(e){return o(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.db.use("jzx_log_immediate_table").get(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.getLogItemsImmediate=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return t=e.map((function(e){return function(t){return t.get(e)}})),[4,this.db.use("jzx_log_immediate_table").batch(t)];case 1:return[2,n.sent()]}}))}))},e.prototype.incrementDeleteLogInImmediateTable=function(e){return o(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return this.judgeDBIsConnected(),console.log("正在删除ImmediateTable的log",e),[4,this.db.use("jzx_log_immediate_table").delete(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.incrementDeleteLogsInImmediateTable=function(e){return o(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return this.judgeDBIsConnected(),console.log("正在删除ImmediateTable的log",e),t=e.map((function(e){return function(t){return t.delete(e)}})),[4,this.db.use("jzx_log_immediate_table").batch(t)];case 1:return n.sent(),[2,{ret:s.RET.SUCCESS}]}}))}))},e.prototype.getAllImediateLogs=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.db.use("jzx_log_immediate_table").all()];case 1:return[2,e.sent()]}}))}))},e.prototype.deleteImediateLog=function(e){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t=this.db.use("jzx_log_immediate_table"),e&&e.length>0?(n=e.map((function(e){return function(t){return t.delete(e.id)}})),[4,t.batch(n)]):[3,2];case 1:return[2,r.sent()];case 2:return[2]}}))}))},e}();t.default=c},function(e,t,n){(function(t){var n;"undefined"!=typeof window?window:void 0!==t||"undefined"!=typeof self&&self,n=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t),n.d(t,"InDB",(function(){return s})),n.d(t,"InDBStore",(function(){return c}));var r=n(1);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var n=t.name,o=t.version,u=void 0===o?1:o,a=t.stores,s=!n;n||(n="__indb__"),a&&Array.isArray(a)&&a.length||(a=[{name:"__indb__",isKv:!0}]),this.name=n,this.version=u,this.stores=a;var c=indexedDB.open(n,u);if(c.onupgradeneeded=function(e){var t=e.target.result,n=Array.from(t.objectStoreNames),r=[];a.forEach((function(o){var i=null;if(n.indexOf(o.name)>-1)i=e.target.transaction.objectStore(o.name);else{var u=o.isKv?"key":o.keyPath,a=!o.isKv&&o.autoIncrement;i=t.createObjectStore(o.name,{keyPath:u,autoIncrement:a})}var s=i.indexNames;s&&s.length&&Array.from(s).forEach((function(e){return i.deleteIndex(e)})),o.indexes&&o.indexes.length&&o.indexes.forEach((function(e){i.createIndex(e.name,e.keyPath||e.name,{unique:e.unique,multiEntry:Array.isArray(e.keyPath)})})),r.push(o.name)})),n&&n.forEach((function(e){-1===r.indexOf(e)&&t.deleteObjectStore(e)}))},c.onblocked=function(e){console.error(Object(r.a)(new Error("indexedDB "+n+" is blocked")))},this.using={},s)return this.use(n)}return a(e,[{key:"connect",value:function(){var e=this;return new Promise((function(t,n){var o=indexedDB.open(e.name,e.version);o.onerror=function(e){n(Object(r.a)(e))},o.onsuccess=function(e){t(e.target.result)}}))}},{key:"use",value:function(e){var t=this.stores.find((function(t){return t.name===e}));if(!t)throw new Error("[InDB]: store ".concat(e," is not existing."));if(this.using[e])return this.using[e];var n=new c({db:this,store:t});return t.isKv&&(n.key=function(e){return n.keys().then((function(t){return t&&t[e]}))},n.getItem=function(e){return n.get(e).then((function(e){return e&&e.value}))},n.setItem=function(e,t){return n.put({key:e,value:t})},n.removeItem=function(e){return n.delete(e)}),this.using[e]=n,n}},{key:"close",value:function(){return this.using=null,this.stores=null,this.connect().then((function(e){e.close()}))}}]),e}();s.deleteDatabase=function(e){return new Promise((function(t,n){var r=indexedDB.deleteDatabase(e);r.onsuccess=function(){t()},r.onerror=function(e){n(e)}}))},s.databases=function(){return indexedDB.databases()},t.default=s;var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e);var n=t.store,r=t.db;if("object"!==o(n)||!n.name||"string"!=typeof n.name)throw new Error("[InDBStore]: options.store should be a store config object.");if(!(r instanceof s))throw new Error("[InDBStore]: options.db should be an instanceof InDB.");this.store=n,this.db=r,this.name=n.name,this.keyPath=n.isKv?"key":n.keyPath}return a(e,[{key:"transaction",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.name,r=t?"readwrite":"readonly",o=this.db.connection,i=o?Promise.resolve(o):this.db.connect();return i.then((function(t){e.db.connection=t;var o=t.transaction(n,r),i=function(){e.db.connection=null};return o.oncomplete=i,o.onabort=i,o.onerror=i,o}))}},{key:"objectStore",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.name;return this.transaction(e).then((function(e){return e.objectStore(t)}))}},{key:"cursor",value:function(e){var t=e.index,n=e.range,o=e.direction,i=e.onTouch,u=e.onDone,a=e.onError,s=e.writable,c=void 0!==s&&s;return this.objectStore(c).then((function(e){var s=t?e.index(t):e,c=s.openCursor(n,o);c.onsuccess=function(e){var t=e.target.result;t?i(t,s):u(t,s)},c.onerror=function(e){a(Object(r.a)(e))}}))}},{key:"request",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.writable,i=void 0!==o&&o;return new Promise((function(n,o){t.objectStore(i).then((function(t){var i=e(t);i.onsuccess=function(e){var t=e.target.result;n(t)},i.onerror=function(e){o(Object(r.a)(e))}}))}))}},{key:"iterate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.index,o=n.range,i=n.writable,u=void 0!==i&&i,a=n.direction,s=void 0===a?"next":a;return new Promise((function(n,i){t.cursor({index:r,range:o,writable:u,direction:s,onTouch:function(t,r){e(t,(function(){return t.continue()}),(function(){r.transaction.commit(),n()}))},onDone:function(){n()},onError:function(e){i(e)}})}))}},{key:"batch",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.writable,i=void 0===o||o;return this.transaction(i).then((function(n){var o=t.name,i=[],u=n.objectStore(o);return e.forEach((function(e){var t=new Promise((function(t,n){var o=e(u);o.onsuccess=function(e){var n=e.target.result;t(n)},o.onerror=function(e){n(Object(r.a)(e))}}));i.push(t)})),Promise.all(i)}))}},{key:"get",value:function(e){if(!Array.isArray(e))return this.request((function(t){return t.get(e)}));var t=e.map((function(e){return function(t){return t.get(e)}}));return this.batch(t,{writable:!1})}},{key:"keys",value:function(){var e=this.keyPath,t=[];return this.each((function(n){var o=Object(r.b)(n,e);t.push(o)})).then((function(){return t}))}},{key:"all",value:function(){var e=[];return this.each((function(t){e.push(t)})).then((function(){return e}))}},{key:"count",value:function(){return this.request((function(e){return e.count()}))}},{key:"each",value:function(e){return this.iterate((function(t,n){var r=t.value;e(r),n()}))}},{key:"reverse",value:function(e){return this.iterate((function(t,n){var r=t.value;e(r),n()}),{direction:"prev"})}},{key:"some",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise((function(r,o){var i,u=[],a=0,s=n,c=n+t;n<0&&(i="prev",t=Math.min(t,-n),c=(s=-(n+t)||0)+t),e.iterate((function(e,t,n){a<s?(a++,t()):a<c?(u.push(e.value),a++,t()):n()}),{direction:i}).then((function(){n<0&&u.reverse(),r(u)})).catch(o)}))}},{key:"first",value:function(){return this.some(1).then((function(e){return e[0]}))}},{key:"last",value:function(){return this.some(1,-1).then((function(e){return e[0]}))}},{key:"find",value:function(e,t){return this.request((function(n){return n.index(e).get(t)}))}},{key:"query",value:function(e,t,n){var o=this,i=function(){switch(n){case">":return IDBKeyRange.lowerBound(t,!0);case">=":return IDBKeyRange.lowerBound(t);case"<":return IDBKeyRange.upperBound(t,!0);case"<=":return IDBKeyRange.upperBound(t);case"%":case"!=":case"in":return;default:return IDBKeyRange.only(t)}}(),u=[];return new Promise((function(a,s){o.cursor({index:e,range:i,onTouch:function(e,o){var i=e.value,a=o.keyPath,s=Object(r.b)(i,a);"!="===n?s!==t&&u.push(i):"%"===n?"string"==typeof s&&s.indexOf(t)>-1&&u.push(i):"in"===n?Array.isArray(t)&&t.indexOf(s)>-1&&u.push(i):u.push(i),e.continue()},onDone:function(){a(u)},onError:function(e){s(e)}})}))}},{key:"select",value:function(e){var t=this.store.indexes||[],n={};t.forEach((function(e){var t=e.name,r=e.keyPath;n[t]=r}));for(var o=[],i=[],u=0,a=e.length;u<a;u++){var s=e[u],c=s.key,l=s.value,f=s.compare,h=s.optional,d=n[c]||c;h?o.push({keyPath:d,value:l,compare:f}):i.push({keyPath:d,value:l,compare:f})}var p=[];return this.each((function(e){(function(e){for(var t=function(e,t,n){if(void 0===e)return!1;switch(n){case">":return e>t;case">=":return e>=t;case"<":return e<t;case"<=":return e<=t;case"!=":return e!==t;case"%":return"string"==typeof e&&e.indexOf(t)>-1;case"in":return Array.isArray(t)&&t.indexOf(e)>-1;default:return e===t}},n=0,u=i.length;n<u;n++){var a=i[n],s=a.keyPath,c=a.value,l=a.compare;if(!t(Object(r.b)(e,s),c,l))return!1}for(var f=0,h=o.length;f<h;f++){var d=o[f],p=d.keyPath,v=d.value,y=d.compare;if(t(Object(r.b)(e,p),v,y))return!0}return!1})(e)&&p.push(e)})).then((function(){return p}))}},{key:"add",value:function(e,t){if(Array.isArray(e)){var n=e;if(n.length<2)return this.add(e[0],t);var r=n.map((function(e){return function(n){return n.add(e,t)}}));return this.batch(r)}return e?this.request((function(n){return n.add(e,t)}),{writable:!0}):Promise.resolve()}},{key:"put",value:function(e,t){if(Array.isArray(e)){var n=e;if(n.length<2)return this.put(n[0],t);var r=n.map((function(e){return function(n){return n.put(e,t)}}));return this.batch(r)}return e?this.request((function(n){return n.put(e,t)}),{writable:!0}):Promise.resolve()}},{key:"delete",value:function(e){if(Array.isArray(e)){var t=e;if(t.length<2)return this.delete(t[0]);var n=t.map((function(e){return function(t){return t.delete(e)}}));return this.batch(n)}return e?this.request((function(t){return t.delete(e)}),{writable:!0}):Promise.resolve()}},{key:"remove",value:function(e){var t=this.keyPath;if(Array.isArray(e)){var n=e;if(n.length<2)return this.remove(n[0]);var o=n.map((function(e){var n=Object(r.b)(e,t);return function(e){return e.delete(n)}}));return this.batch(o)}if(!e)return Promise.resolve();var i=Object(r.b)(e,t);return i?this.delete(i):Promise.resolve()}},{key:"clear",value:function(){return this.request((function(e){return e.clear()}),{writable:!0})}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!Array.isArray(t)){var n=function(e){return e.toString().split(/\.|\[|\]/).filter((function(e){return!!e}))}(t);if(!n.length)return e;for(var o=e,i=0,u=n.length;i<u;i++){var a=n[i];if(void 0===o[a])return;o=o[a]}return o}for(var s=0,c=t.length;s<c;s++){var l=r(e,t[s]);if(void 0!==l)return l}}function o(e){var t=e.message;return e.message=-1===t.indexOf("[IndexedDB]")?"[IndexedDB]: "+t:t,e}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))}])},e.exports=n()}).call(this,n(8))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,a)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.queue=[],this.operationRunning=!1,this.initState=!0,this.queue=[]}return e.prototype.loganOperationsRecursion=function(){return r(this,void 0,void 0,(function(){var e,t,n;return o(this,(function(r){switch(r.label){case 0:if(!(this.queue.length>0)||this.operationRunning)return[3,5];e=this.queue.shift(),this.operationRunning=!0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.asyncF()];case 2:return t=r.sent(),e.resolveF(t),[3,4];case 3:return n=r.sent(),e.rejectF(n),[3,4];case 4:return this.operationRunning=!1,this.loganOperationsRecursion(),[3,0];case 5:return 0===this.queue.length&&!1===this.initState&&(console.info("执行完毕",Date.now()),this.initState=!0),[2]}}))}))},e.prototype.invokeInQueue=function(e){return r(this,void 0,void 0,(function(){var t=this;return o(this,(function(n){return!0===this.initState&&(this.initState=!1),[2,new Promise((function(n,r){t.queue.push({asyncF:e,resolveF:n,rejectF:r}),t.loganOperationsRecursion()}))]}))}))},e}();t.default=i},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,a)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(11),a=n(0),s=n(2),c=function(){function e(){this.duration=3e3,this.repeat=2,this.repeat=s.default.get("repeat")||2,this.duration=s.default.get("duration")||3e3,this.handleResponse=s.default.get("handleResponse"),this.handleRequest=s.default.get("handleRequest")}return e.prototype.report=function(e){var t=e.data;return o(this,void 0,void 0,(function(){var e,n,o,c,l,f=this;return i(this,(function(i){switch(i.label){case 0:return console.log("------上传的data----",t),e=s.default.getAll(),n=e.url,o=e.method,c=e.headers,l=void 0===c?{}:c,!1===/^((https:\/\/)|(http:\/\/))/.test(n)?(console.error("上报的url:"+n+"不符合域名格式,请重新配置"),[2,{ret:a.RET.FAILED,error:n+"不符合域名格式"}]):[4,this.retry((function(){return u.default(n,JSON.stringify(f.handleRequest(t)),!1,o||"get",r({"Content-Type":"application/json"},l))}),this.repeat)];case 1:return[2,i.sent()]}}))}))},e.prototype.retry=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o,u,s=this;return i(this,(function(i){switch(i.label){case 0:return[4,e()];case 1:return(n=i.sent()).ret===a.RET.FAILED?0===t?[2,n]:[2,Promise.resolve(setTimeout((function(){return s.retry(e,Number(t)-1)}),Number(this.duration)))]:(r=this.handleResponse(n.data),o=r.ret,u=r.error,console.log("----------",o,u),[2,{ret:o,error:u}])}}))}))},e}();t.default=c},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function u(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,a)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(12),u=n(0);t.default=function(e,t,n,a,s){return r(void 0,void 0,void 0,(function(){return o(this,(function(r){return[2,new Promise((function(r,o){i.default({url:e,type:a||"GET",data:t,withCredentials:!!n,headers:s,success:function(e){r({ret:u.RET.SUCCESS,data:e})},fail:function(e){console.log("error XHR",new Error(e||"error")),r({ret:u.RET.FAILED,error:e||"Request failed"})}})}))]}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(0);t.default=function(e){var t=new XMLHttpRequest;if(t.open(e.type||"GET",e.url,!0),t.withCredentials=e.withCredentials,t.onreadystatechange=function(){if(4===t.readyState){var n=t.status;200==n?e.success&&e.success(t.responseText):e.fail&&e.fail("Request failed, status: "+n+", responseText: "+t.responseText)}},"POST"===e.type){if(e.headers)for(var n in e.headers)t.setRequestHeader(n,e.headers[n]);t.send(e.data)}else t.send();return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.operationRunning=!1,this.runStart=!1,this.queue=[],this.logOperate=e}return e.prototype.startOperate=function(){this.runStart=!0,this.operatingRecursion()},e.prototype.operatingRecursion=function(){if(this.runStart&&!this.operationRunning&&this.queue.length>0&&(this.operationRunning=!0,this.queue.length>0)){var e=this.queue.splice(0,this.queue.length);console.log("移除的日志",e),this.logOperate&&this.logOperate(e),this.operationRunning=!1,this.operatingRecursion()}},e.prototype.invokePushQueue=function(e){this.queue.push(e),this.operatingRecursion()},e}();t.default=r}]);